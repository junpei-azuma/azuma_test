# DataBaseの設計ガイドライン

全てのコードに[copilot-instructions.md](../copilot-instructions.md)の内容を適用する。

## 概念設計

TBD
## 論理設計

- 関係データベースを使用する。
- 原則として第二正規化を適用する。第三正規化を適用する場合は必ずレビューを行い、理由を明確にする。
- データベース設計
  - `app`データベースを使用する。
- テーブル設計
  - 英語で命名する。
  - 単数形で命名する。
  - `snake_case`を使用する。
  - 例: `user`, `order_item`
  - `t_`や`m_`などのプレフィックスは使用しない。
- カラム設計
  - IDはアプリケーション側で生成する。自動インクリメントは使用しない。
  - IDはULIDを使用する。
  - カラム名は英語で命名する。
  - `snake_case`を使用する。
    - 例: `created_at`, `updated_at`
- スキーマ
  - `app`スキーマを使用する。`public`スキーマを使用しない。
  - 全てのテーブルを`app`スキーマに配置する。DBマイグレーション時間が長くなることを避けるために、スキーマを分割しない。
- セキュリティ
  - 最小権限・職務分掌の原則に従う。
  - `postgres`ユーザーは使用しない。以下のユーザを使用する。
    - `app`ユーザー: アプリケーションからDBにアクセスするためのユーザ。
      - DML権限を付与する。
      - DDL権限は付与しない。
    - `db_admin`ユーザー: DBの管理を行うユーザ。
        - DDL権限を付与する。

## 物理設計

本リポジトリでは物理設計は行わない。

